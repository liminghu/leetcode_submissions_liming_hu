{"id":1517435749,"question_id":2587,"lang":"cpp","lang_name":"C++","time":"2 weeks, 1 day","timestamp":1737595151,"status":10,"status_display":"Accepted","runtime":"15 ms","url":"/submissions/detail/1517435749/","is_pending":"Not Pending","title":"Design Memory Allocator","memory":"38.7 MB","code":"class Allocator {\nunordered_map<int, vector<pair<int,int>>> alloc;\nmap<int, int> avail;  //start, end\n\npublic:\n    Allocator(int n) {\n        avail.insert({0, n});        \n    }\n    \n    int allocate(int size, int mID) {\n        for(auto it = begin(avail); it!=end(avail); it++) {\n            if(it->second>=size) {\n                auto [i, i_sz] = *it;\n                alloc[mID].push_back({i, size});\n                avail.erase(it);\n                if(i_sz > size) {\n                    avail.insert({i+size, i_sz-size});\n                }\n                return i;\n            }\n        }\n        return -1;\n    }\n    \n    int freeMemory(int mID) {\n        int res = 0;\n        if(auto it=alloc.find(mID); it!=end(alloc)) {\n            for(auto [i, sz]: it->second) {\n                auto ita = avail.insert({i, sz}).first;\n                if(ita!= begin(avail)) {\n                    if(auto p = prev(ita); p->first +p->second == i) {\n                        p->second += sz;\n                        avail.erase(ita);\n                        ita = p;\n                    }\n                }\n                if(next(ita)!=end(avail)) {\n                    if(auto n=next(ita); i+sz == n->first) {\n                        ita->second += n->second;\n                        avail.erase(n);\n                    }\n                }\n                res += sz;\n            }\n            alloc.erase(it);\n        }\n        return res;\n    }\n};\n\n/**\n * Your Allocator object will be instantiated and called as such:\n * Allocator* obj = new Allocator(n);\n * int param_1 = obj->allocate(size,mID);\n * int param_2 = obj->freeMemory(mID);\n */","compare_result":"1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111","title_slug":"design-memory-allocator","has_notes":false,"flag_type":1}