{"id":1485010891,"question_id":2012,"lang":"cpp","lang_name":"C++","time":"1 month, 2 weeks","timestamp":1734833936,"status":10,"status_display":"Accepted","runtime":"195 ms","url":"/submissions/detail/1485010891/","is_pending":"Not Pending","title":"Process Tasks Using Servers","memory":"131.3 MB","code":"using PII = pair<int,int>;\nclass Solution {\npublic:\n    vector<int> assignTasks(vector<int>& servers, vector<int>& tasks) {\n        int n = servers.size();\n        int m = tasks.size();\n        //servers[i] is the weight of the i​​​​​​th​​​​ server, and tasks[j] is the time needed to process the j​​​​​​th​​​​ task in seconds.\n        vector<int> rets(m, -1);\n        priority_queue<PII, vector<PII>, greater<>> pq_free_server;\n        priority_queue<array<int,3>, vector<array<int,3>>, greater<>> pq_busy_server;\n        int i=0;\n        for(auto server:servers) {\n            pq_free_server.push({server, i});\n            i++;\n        };\n\n        queue<int> jobs;\n\n        for(int j=0; j<tasks.size(); j++) {\n            jobs.push(j);\n            while(!pq_busy_server.empty() && pq_busy_server.top()[0]<=j) {\n                auto [t, w, idx] = pq_busy_server.top();\n                pq_busy_server.pop();\n                pq_free_server.push({w, idx});\n            }\n            while(!jobs.empty() && !pq_free_server.empty()) {\n                int job = jobs.front();\n                jobs.pop();\n                auto [w,idx] = pq_free_server.top();\n                pq_free_server.pop();\n                rets[job] = idx;\n                pq_busy_server.push({j+tasks[job], w, idx});\n            }\n        }\n        while(!jobs.empty()) {\n            int job = jobs.front();\n            jobs.pop();\n            auto [t, w, idx] = pq_busy_server.top();\n            pq_busy_server.pop();\n            rets[job] = idx;\n            pq_busy_server.push({t+tasks[job], w, idx});                        \n        }\n        return rets;\n    }\n};","compare_result":"111111111111111111111111111111111111","title_slug":"process-tasks-using-servers","has_notes":false,"flag_type":1}